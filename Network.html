<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
    
  Network - Hampus Blog
  
  </title>
 <meta name="description" content="Free is never free.">
 <link href="atom.xml" rel="alternate" title="Hampus Blog" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.min.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />

    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
    <script src="asset/highlightjs/highlight.pack.js"></script>
    <link href="asset/highlightjs/styles/github.css" media="screen, projection" rel="stylesheet" type="text/css">
    <script>hljs.initHighlightingOnLoad();</script>
    
  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>

<div id="header">
    <h1><a href="index.html">Hampus Blog</a></h1>
</div>

</nav>
        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; Hampus Blog</span>
  </a>
</nav>

<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
      <li><a href="index.html">Home</a></li>
      
        <li class="divider"></li>
        <li><label>Material</label></li>

          
            <li><a title="Free Alternatives to Gaussian" href="15136684903532.html">Free Alternatives to Gaussian</a></li>
          
            <li><a title="Advanced Materials Through AI & Computational Materials Science" href="15136677588220.html">Advanced Materials Through AI & Computational Materials Science</a></li>
          

      
        <li class="divider"></li>
        <li><label>Network</label></li>

          
            <li><a title="Drive Headless Chromium with Python3" href="15136691816848.html">Drive Headless Chromium with Python3</a></li>
          
            <li><a title="Sending raw Ethernet packets from a specific interface in C on Linux" href="15136687695430.html">Sending raw Ethernet packets from a specific interface in C on Linux</a></li>
          
            <li><a title="Inevitable Comparison: TCP vs UDP" href="15136683515000.html">Inevitable Comparison: TCP vs UDP</a></li>
          
            <li><a title="Differences between TLS 1.2 and TLS 1.3" href="15136685483165.html">Differences between TLS 1.2 and TLS 1.3</a></li>
          

      
        <li class="divider"></li>
        <li><label>Offtopics</label></li>

          
            <li><a title="Thoughts on the Nintendo Switch" href="15136686867614.html">Thoughts on the Nintendo Switch</a></li>
          

      
      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>

        <section id="main-content" role="main" class="scroll-container">

          <div class="row">
            <div class="large-3 medium-3 columns">
              <div class="hide-for-small">
                <div class="sidebar">
                <nav>
                  <ul id="side-nav" class="side-nav">

                    
                      <li class="side-title"><span>Material</span></li>
                        
                          <li><a title="Free Alternatives to Gaussian" href="15136684903532.html">Free Alternatives to Gaussian</a></li>
                        
                          <li><a title="Advanced Materials Through AI & Computational Materials Science" href="15136677588220.html">Advanced Materials Through AI & Computational Materials Science</a></li>
                        

                    
                      <li class="side-title"><span>Network</span></li>
                        
                          <li><a title="Drive Headless Chromium with Python3" href="15136691816848.html">Drive Headless Chromium with Python3</a></li>
                        
                          <li><a title="Sending raw Ethernet packets from a specific interface in C on Linux" href="15136687695430.html">Sending raw Ethernet packets from a specific interface in C on Linux</a></li>
                        
                          <li><a title="Inevitable Comparison: TCP vs UDP" href="15136683515000.html">Inevitable Comparison: TCP vs UDP</a></li>
                        
                          <li><a title="Differences between TLS 1.2 and TLS 1.3" href="15136685483165.html">Differences between TLS 1.2 and TLS 1.3</a></li>
                        

                    
                      <li class="side-title"><span>Offtopics</span></li>
                        
                          <li><a title="Thoughts on the Nintendo Switch" href="15136686867614.html">Thoughts on the Nintendo Switch</a></li>
                        

                    
                  </ul>
                </nav>
                </div>
              </div>
            </div>
            <div class="large-9 medium-9 columns">

 


	
		<div class="markdown-body">
		<h1>Drive Headless Chromium with Python3</h1>

		<h1 id="toc_0">Browser Automation</h1>

<p>Before we dive into any code, let’s talk about what a headless browser is and why it’s useful. In short, headless browsers are web browsers without a graphical user interface (GUI) and are usually controlled programmatically or via a command-line interface.  </p>

<p>One of the many use cases for headless browsers is automating usability testing or testing browser interactions. If you’re trying to check how a page may render in a different browser or confirm that page elements are present after a user initiates a certain workflow, using a headless browser can provide a lot of assistance. In addition to this, traditional web-oriented tasks like web scraping can be difficult to do if the content is rendered dynamically (say, via Javascript). Using a headless browser allows easy access to this content because the content is rendered exactly as it would be in a full browser.  </p>

<h1 id="toc_1">Headless Chrome and Python</h1>

<h2 id="toc_2">Going Headless!</h2>

<h3 id="toc_3">Setup</h3>

<p>Before we get started, we need to install Chromium and download the latest ChromeDriver.</p>

<p>Next, let’s make a folder that will contain all of our files:  </p>

<pre><code>mkdir going_headless
#Now we can move the ChromeDriver into the directory that we just made:
mv Downloads/chromedriver going_headless/
</code></pre>

<p>Since we are using Selenium with Python, it’s a good idea to make a Python virtual environment. I use virtualenv, so if you use another virtual environment manager, the commands may be different.  </p>

<pre><code>$ cd going_headless &amp;&amp; virtualenv -p python3 env  
$ source env/bin/activate
</code></pre>

<p>The next thing we need to do is install Selenium. If you’re not familiar with Selenium, it’s a suite of tools that allows developers to programmatically drive web browsers. It has language bindings for Java, C#, Ruby, Javascript (Node), and Python. To install the Selenium package for Python, we can run the following:  </p>

<pre><code>pip3 install selenium  
</code></pre>

<h3 id="toc_4">Example</h3>

<p>Now that we’ve gotten all of that out of the way, let’s get to the fun part. Our goal is to write a script that searches for my name “Hamples” on back.re, and checks that a recent article I wrote about Android security is listed in the results. If you’ve followed the instructions above, you can use the headless version of Chromium with Selenium like so:  </p>

<pre><code>import os  
from selenium import webdriver  
from selenium.webdriver.common.keys import Keys  
from selenium.webdriver.chrome.options import Options`  

`chrome_options = Options()  
chrome_options.add_argument(&quot;--headless&quot;)  
chrome_options.binary_location = &#39;/Applications/Google Chromium.app/Contents/MacOS/Google Chromium&#39;`    

`driver = webdriver.Chrome(executable_path=os.path.abspath(“chromedriver&quot;),   chrome_options=chrome_options)  
driver.get(&quot;https://back.re&quot;)`  

`magnifying_glass = driver.find_element_by_id(&quot;js-open-icon&quot;)  
if magnifying_glass.is_displayed():  
  magnifying_glass.click()  
else:  
  menu_button = driver.find_element_by_css_selector(&quot;.menu-trigger.local&quot;)  
  menu_button.click()`  

`search_field = driver.find_element_by_id(&quot;site-search&quot;)  
search_field.clear()  
search_field.send_keys(&quot;Hamples&quot;)  
search_field.send_keys(Keys.RETURN)  
assert &quot;Nothing...&quot; in driver.page_source   driver.close()` 
</code></pre>

<h3 id="toc_5">Example Explained</h3>

<p>The driver.get function will be used navigate to the specified URL.</p>

<pre><code>driver.get(&quot;https://back.re&quot;)
</code></pre>

<p>The back.re website is responsive, so we have to handle different conditions. As a result, we check to see if the expected search button is displayed. If it isn’t, we click the menu button to enter our search term.  </p>

<pre><code>magnifying_glass = driver.find_element_by_id(&quot;js-open-icon&quot;)  
if magnifying_glass.is_displayed():  
  magnifying_glass.click()  
else:  
  menu_button = driver.find_element_by_css_selector(&quot;.menu-trigger.local&quot;)  
  menu_button.click()  
</code></pre>

<p>Now we clear the search field, search for my name, and send the RETURN key to the drive.  </p>

<pre><code>search_field = driver.find_element_by_id(&quot;site-search&quot;)  
search_field.clear()  
search_field.send_keys(&quot;Olabode&quot;)  
search_field.send_keys(Keys.RETURN)
</code></pre>

<p>We check to make sure that the blog post title from one of my most recent posts is in the page’s source.  </p>

<pre><code>assert &quot;Nothing...&quot; in driver.page_source
</code></pre>

<p>And finally, we close the browser.</p>

<p><code>driver.close()</code>.</p>

<h2 id="toc_6">Benchmarks</h2>

<h3 id="toc_7">Head to Headless</h3>

<p>So, it’s cool that we can now control Chrome using Selenium and Python without having to see a browser window, but we are more interested in the performance benefits we talked about earlier. Using the same script above, we profiled the time it took to complete the tasks, peak memory usage, and CPU percentage. We polled CPU and memory usage with psutil and measured the time for task completion using timeit.  </p>

<p>For our small script, there were very small differences in the amount of time taken to complete the task (4.3%), memory usage (.5%), and CPU percentage (5.2%). While the gains in our example were very minimal, these gains would prove to be beneficial in a test suite with dozens of tests.  </p>

<h1 id="toc_8">Resources</h1>

<p>Chrome Links:  </p>

<ul>
<li><a href="https://www.chromium.org/getting-involved/download-chromium">Chromium</a></li>
<li><a href="https://sites.google.com/a/chromium.org/chromedriver/downloads">Chrome Drive</a></li>
<li><a href="https://chromedevtools.github.io/devtools-protocol/">DevTools API</a></li>
</ul>

<p>Selenium Links:  </p>

<ul>
<li><a href="https://www.seleniumhq.org/">Selenium HQ</a></li>
<li><a href="https://selenium-python.readthedocs.io/">Python package</a></li>
</ul>


		</div>
	

 
	

 
	

 
	

  
  
</div></div>


<div class="page-bottom">
  <div class="row">
  <hr />
  <div class="small-9 columns">
  <p class="copyright">Copyright &copy; 2015
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
  <div class="small-3 columns">
  <p class="copyright text-right"><a href="#header">TOP</a></p>
  </div>
   
  </div>
</div>

        </section>
      </div>
    </div>
    
    
    <script src="asset/js/foundation.min.js"></script>
    <script src="asset/js/foundation/foundation.offcanvas.js"></script>
    <script>
      $(document).foundation();

     
    </script>
    <script src="asset/chart/all-min.js"></script><script type="text/javascript">$(function(){    var mwebii=0;    var mwebChartEleId = 'mweb-chart-ele-';    $('pre>code').each(function(){        mwebii++;        var eleiid = mwebChartEleId+mwebii;        if($(this).hasClass('language-sequence')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = Diagram.parse($(this).text());            diagram.drawSVG(eleiid,{theme: 'simple'});        }else if($(this).hasClass('language-flow')){            var ele = $(this).addClass('nohighlight').parent();            $('<div id="'+eleiid+'"></div>').insertAfter(ele);            ele.hide();            var diagram = flowchart.parse($(this).text());            diagram.drawSVG(eleiid);        }    });});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  </body>
</html>
